<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>çš®è‚¤ä»£ç ç”Ÿæˆå™¨</title>
<style>
* { box-sizing: border-box; margin:0; padding:0; }
body {
  font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  color: #333;
  min-height: 100vh;
  padding-bottom: 20px;
}
.container {
  max-width: 1200px;
  margin: 0 auto;
  padding: 20px;
}
header {
  background: rgba(255,255,255,0.95);
  backdrop-filter: blur(10px);
  color: #4a5568;
  padding: 20px;
  text-align: center;
  font-size: 28px;
  font-weight: bold;
  letter-spacing: 1px;
  border-radius: 16px;
  margin-bottom: 20px;
  box-shadow: 0 8px 32px rgba(0,0,0,0.1);
  border: 1px solid rgba(255,255,255,0.2);
}

/* æ§åˆ¶é¢æ¿æ ·å¼ */
.control-panel {
  background: rgba(255,255,255,0.95);
  backdrop-filter: blur(10px);
  border-radius: 16px;
  padding: 20px;
  margin-bottom: 20px;
  box-shadow: 0 8px 32px rgba(0,0,0,0.1);
  border: 1px solid rgba(255,255,255,0.2);
}

.search-hero-container {
  display: flex;
  gap: 15px;
  margin-bottom: 15px;
  flex-wrap: wrap;
}

#toggleHeroPanel {
  flex: 0 0 auto;
  background: linear-gradient(135deg, #667eea, #764ba2);
  color: white;
  border: none;
  padding: 12px 20px;
  border-radius: 10px;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.3s ease;
  box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
}

#toggleHeroPanel:hover {
  transform: translateY(-2px);
  box-shadow: 0 6px 20px rgba(102, 126, 234, 0.6);
}

.search-box {
  flex: 1;
  min-width: 200px;
}

.search-box input {
  width: 100%;
  padding: 12px 16px;
  font-size: 16px;
  border-radius: 10px;
  border: 2px solid #e2e8f0;
  background: white;
  transition: all 0.3s ease;
}

.search-box input:focus {
  outline: none;
  border-color: #667eea;
  box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
}

.top-actions {
  display: flex;
  flex-wrap: wrap;
  gap: 10px;
  margin-bottom: 15px;
  align-items: center;
}

.btn {
  padding: 12px 20px;
  border: none;
  border-radius: 10px;
  color: white;
  font-size: 14px;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.3s ease;
  background: linear-gradient(135deg, #667eea, #764ba2);
  box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
}

.btn:hover {
  transform: translateY(-2px);
  box-shadow: 0 6px 20px rgba(102, 126, 234, 0.6);
}

.small-btn {
  padding: 10px 16px;
  border: none;
  border-radius: 8px;
  color: white;
  font-size: 14px;
  cursor: pointer;
  transition: all 0.3s ease;
  background: #4a5568;
}

.small-btn:hover {
  background: #2d3748;
  transform: translateY(-1px);
}

select.small-btn {
  padding: 10px;
  background: #4a5568;
  color: white;
  border: none;
  border-radius: 8px;
}

/* è‹±é›„é¢æ¿æ ·å¼ */
.hero-panel {
  display: none;
  background: rgba(255,255,255,0.95);
  border-radius: 16px;
  padding: 20px;
  margin-bottom: 20px;
  box-shadow: 0 8px 32px rgba(0,0,0,0.1);
  border: 1px solid rgba(255,255,255,0.2);
}

.hero-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
  gap: 15px;
  max-height: 300px;
  overflow-y: auto;
  padding: 10px;
}

.hero-card {
  background: white;
  border-radius: 12px;
  padding: 15px 10px;
  text-align: center;
  cursor: pointer;
  transition: all 0.3s ease;
  border: 2px solid transparent;
  box-shadow: 0 4px 15px rgba(0,0,0,0.1);
}

.hero-card:hover {
  transform: translateY(-3px);
  box-shadow: 0 8px 25px rgba(0,0,0,0.15);
}

.hero-card.active {
  border-color: #667eea;
  background: linear-gradient(135deg, #f7fafc, #edf2f7);
  box-shadow: 0 6px 20px rgba(102, 126, 234, 0.3);
}

.hero-card .hero-avatar {
  width: 60px;
  height: 60px;
  border-radius: 50%;
  margin: 0 auto 8px;
  background: linear-gradient(135deg, #667eea, #764ba2);
  display: flex;
  align-items: center;
  justify-content: center;
  color: white;
  font-weight: bold;
  font-size: 20px;
}

.hero-card .hero-name {
  font-size: 14px;
  font-weight: 600;
  color: #2d3748;
}

/* çš®è‚¤åˆ—è¡¨æ ·å¼ */
.skin-section {
  background: rgba(255,255,255,0.95);
  backdrop-filter: blur(10px);
  border-radius: 16px;
  padding: 20px;
  margin-bottom: 20px;
  box-shadow: 0 8px 32px rgba(0,0,0,0.1);
  border: 1px solid rgba(255,255,255,0.2);
}

.skin-section h3 {
  color: #2d3748;
  margin-bottom: 15px;
  font-size: 20px;
  border-bottom: 2px solid #e2e8f0;
  padding-bottom: 8px;
}

.skin-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
  gap: 15px;
}

.skin-card {
  background: white;
  border-radius: 12px;
  padding: 15px;
  display: flex;
  align-items: center;
  justify-content: space-between;
  box-shadow: 0 4px 15px rgba(0,0,0,0.1);
  transition: all 0.3s ease;
  border: 1px solid #e2e8f0;
}

.skin-card:hover {
  transform: translateY(-3px);
  box-shadow: 0 8px 25px rgba(0,0,0,0.15);
}

.skin-card .skin-info {
  display: flex;
  align-items: center;
  gap: 12px;
  flex: 1;
}

.skin-card .skin-avatar {
  width: 50px;
  height: 50px;
  border-radius: 50%;
  background: linear-gradient(135deg, #667eea, #764ba2);
  display: flex;
  align-items: center;
  justify-content: center;
  color: white;
  font-weight: bold;
  font-size: 18px;
}

.skin-card .skin-details {
  flex: 1;
}

.skin-card .skin-hero {
  font-weight: 600;
  color: #2d3748;
  font-size: 16px;
}

.skin-card .skin-name {
  color: #4a5568;
  font-size: 14px;
}

.skin-card .skin-code {
  color: #718096;
  font-size: 12px;
  margin-top: 4px;
}

.skin-card .add-btn {
  background: linear-gradient(135deg, #48bb78, #38a169);
  color: white;
  border: none;
  padding: 8px 16px;
  border-radius: 8px;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.3s ease;
}

.skin-card .add-btn:hover {
  transform: translateY(-2px);
  box-shadow: 0 4px 15px rgba(72, 187, 120, 0.4);
}

/* å·²é€‰åˆ—è¡¨æ ·å¼ */
.selected-list {
  background: rgba(255,255,255,0.95);
  backdrop-filter: blur(10px);
  border-radius: 16px;
  padding: 20px;
  box-shadow: 0 8px 32px rgba(0,0,0,0.1);
  border: 1px solid rgba(255,255,255,0.2);
}

.selected-list h3 {
  color: #2d3748;
  margin-bottom: 15px;
  font-size: 20px;
  border-bottom: 2px solid #e2e8f0;
  padding-bottom: 8px;
}

.code-line {
  background: white;
  border-radius: 10px;
  padding: 15px;
  margin-bottom: 10px;
  display: flex;
  justify-content: space-between;
  align-items: center;
  box-shadow: 0 2px 8px rgba(0,0,0,0.1);
  border-left: 4px solid #667eea;
  opacity: 0;
  animation: fadeInUp 0.4s forwards;
}

.code-line .code-text {
  flex: 1;
  font-family: 'Courier New', monospace;
  font-size: 14px;
  color: #2d3748;
  padding-right: 15px;
}

.code-line .code-actions {
  flex-shrink: 0;
  display: flex;
  gap: 8px;
}

/* Toast æç¤º */
.toast {
  position: fixed;
  bottom: 30px;
  left: 50%;
  transform: translateX(-50%);
  background: rgba(45, 55, 72, 0.95);
  color: white;
  padding: 12px 24px;
  border-radius: 10px;
  display: none;
  z-index: 1000;
  box-shadow: 0 8px 32px rgba(0,0,0,0.3);
  backdrop-filter: blur(10px);
}

/* åŠ¨ç”» */
@keyframes fadeInUp {
  from {
    opacity: 0;
    transform: translateY(10px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

/* å“åº”å¼è®¾è®¡ */
@media (max-width: 768px) {
  .container {
    padding: 10px;
  }
  
  .skin-grid {
    grid-template-columns: 1fr;
  }
  
  .hero-grid {
    grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
  }
  
  .search-hero-container {
    flex-direction: column;
  }
  
  .top-actions {
    justify-content: center;
  }
}
</style>
</head>
<body>
<header>ğŸ® çš®è‚¤ä»£ç ç”Ÿæˆå™¨</header>
<div class="container">
  <div class="control-panel">
    <div class="search-hero-container">
      <button id="toggleHeroPanel" class="btn">ğŸ‘¥ è‹±é›„åˆ—è¡¨</button>
      <div class="search-box">
        <input id="search" placeholder="ğŸ” æœç´¢è§’è‰²æˆ–çš®è‚¤...">
      </div>
    </div>
    <div class="top-actions">
      <button id="copyAll" class="btn">ğŸ“‹ å¤åˆ¶å…¨éƒ¨ä»£ç </button>
      <button id="clearAll" class="small-btn">ğŸ—‘ï¸ æ¸…ç©º</button>
      <select id="formatSelect" class="small-btn">
        <option value="default">ğŸ“ é»˜è®¤æ ¼å¼</option>
        <option value="kaito">ğŸ¨ å¿«æ–—ç¾åŒ–</option>
        <option value="shusheng">âœ¨ ä¹¦ç¬™ç¾åŒ–</option>
      </select>
    </div>
  </div>

  <div class="hero-panel" id="heroPanel">
    <div class="hero-grid" id="heroGrid"></div>
  </div>

  <div class="skin-section">
    <h3>ğŸ­ å¯é€‰çš®è‚¤</h3>
    <div class="skin-grid" id="skinList"></div>
  </div>

  <div class="selected-list">
    <h3>ğŸ“œ å·²é€‰ä»£ç </h3>
    <div id="selectedList"></div>
  </div>
</div>

<div id="toast" class="toast"></div>

<script>
const search = document.getElementById('search');
const skinList = document.getElementById('skinList');
const selectedList = document.getElementById('selectedList');
const copyAllBtn = document.getElementById('copyAll');
const clearAllBtn = document.getElementById('clearAll');
const toast = document.getElementById('toast');
const formatSelect = document.getElementById('formatSelect');
const toggleHeroPanelBtn = document.getElementById('toggleHeroPanel');
const heroPanel = document.getElementById('heroPanel');
const heroGrid = document.getElementById('heroGrid');

let data = [], selected = [], currentHero = null;

function showToast(msg) {
  toast.innerText = msg;
  toast.style.display = 'block';
  setTimeout(() => toast.style.display = 'none', 2000);
}

function applyFormat(heroCode, skinCode, name, skinName) {
  const f = formatSelect.value;
  if (f === 'kaito') return `${heroCode}-${skinCode}-0  #${name}-${skinName}`;
  if (f === 'shusheng') return `${heroCode} ${skinCode} 1  #${name}-${skinName}`;
  return `${heroCode} ${skinCode}  #${name}-${skinName}`;
}

function renderHeroPanel() {
  heroGrid.innerHTML = '';
  data.forEach(ch => {
    const heroCard = document.createElement('div');
    heroCard.className = 'hero-card';
    if (currentHero === ch.name) heroCard.classList.add('active');
    
    heroCard.innerHTML = `
      <div class="hero-avatar">${ch.name.charAt(0)}</div>
      <div class="hero-name">${ch.name}</div>
    `;
    
    heroCard.onclick = () => {
      currentHero = currentHero === ch.name ? null : ch.name;
      renderHeroPanel();
      renderSkins(currentHero ? data.filter(ch2 => ch2.name === currentHero) : data);
    };
    
    heroGrid.appendChild(heroCard);
  });
}

function getFilteredSkins() {
  let list = data;
  if (currentHero) list = list.filter(ch => ch.name === currentHero);
  const v = search.value.trim();
  if (v) {
    list = list.map(ch => ({
      name: ch.name,
      heroCode: ch.heroCode,
      skins: ch.skins.filter(s => 
        ch.name.toLowerCase().includes(v.toLowerCase()) || 
        s.name.toLowerCase().includes(v.toLowerCase())
      )
    })).filter(ch => ch.skins.length > 0);
  }
  return list;
}

function renderSkins(list) {
  skinList.innerHTML = '';
  list.forEach(ch => {
    ch.skins.forEach(skin => {
      const skinCard = document.createElement('div');
      skinCard.className = 'skin-card';
      skinCard.innerHTML = `
        <div class="skin-info">
          <div class="skin-avatar">${ch.name.charAt(0)}</div>
          <div class="skin-details">
            <div class="skin-hero">${ch.name}</div>
            <div class="skin-name">${skin.name}</div>
            <div class="skin-code">${ch.heroCode}-${skin.skinCode}</div>
          </div>
        </div>
        <button class="add-btn">+ æ·»åŠ </button>
      `;
      skinCard.querySelector('.add-btn').onclick = () => 
        addSkin(ch.heroCode, skin.skinCode, ch.name, skin.name);
      skinList.appendChild(skinCard);
    });
  });
}

function addSkin(heroCode, skinCode, name, skinName) {
  selected.push({heroCode, skinCode, name, skinName});
  renderSelected();
  showToast(`å·²æ·»åŠ : ${name}-${skinName}`);
}

function renderSelected() {
  selectedList.innerHTML = '';
  if (selected.length === 0) {
    selectedList.innerHTML = '<div style="text-align: center; color: #718096; padding: 40px;">æš‚æ— å·²é€‰ä»£ç </div>';
    return;
  }
  
  selected.forEach((item, idx) => {
    const line = document.createElement('div');
    line.className = 'code-line';
    line.style.animationDelay = `${idx * 0.1}s`;
    line.innerHTML = `
      <div class="code-text">${applyFormat(item.heroCode, item.skinCode, item.name, item.skinName)}</div>
      <div class="code-actions">
        <button class="small-btn" onclick="copySingle(${idx})">å¤åˆ¶</button>
        <button class="small-btn" onclick="removeLine(${idx})">ç§»é™¤</button>
      </div>
    `;
    selectedList.appendChild(line);
  });
}

function removeLine(i) {
  const removed = selected.splice(i, 1)[0];
  renderSelected();
  showToast(`å·²ç§»é™¤: ${removed.name}-${removed.skinName}`);
}

function copySingle(i) {
  const item = selected[i];
  const text = applyFormat(item.heroCode, item.skinCode, item.name, item.skinName);
  navigator.clipboard.writeText(text).then(() => showToast('å·²å¤åˆ¶å•æ¡ä»£ç ')).catch(() => showToast('å¤åˆ¶å¤±è´¥'));
}

// äº‹ä»¶ç›‘å¬
copyAllBtn.onclick = () => {
  if (!selected.length) {
    showToast('æ²¡æœ‰å¯å¤åˆ¶çš„ä»£ç ');
    return;
  }
  const text = selected.map(s => applyFormat(s.heroCode, s.skinCode, s.name, s.skinName)).join('\n');
  navigator.clipboard.writeText(text).then(() => showToast('å·²å¤åˆ¶å…¨éƒ¨ä»£ç ')).catch(() => showToast('å¤åˆ¶å¤±è´¥'));
};

clearAllBtn.onclick = () => {
  if (selected.length === 0) {
    showToast('å·²æ¸…ç©º');
    return;
  }
  selected = [];
  renderSelected();
  showToast('å·²æ¸…ç©ºæ‰€æœ‰ä»£ç ');
};

search.oninput = () => {
  renderSkins(getFilteredSkins());
};

formatSelect.onchange = () => {
  renderSelected();
};

toggleHeroPanelBtn.onclick = () => {
  const isVisible = heroPanel.style.display === 'block';
  heroPanel.style.display = isVisible ? 'none' : 'block';
  toggleHeroPanelBtn.textContent = isVisible ? 'ğŸ‘¥ è‹±é›„åˆ—è¡¨' : 'ğŸ‘¥ éšè—åˆ—è¡¨';
};

// åŠ è½½æ•°æ®
fetch('skins.json')
  .then(r => r.json())
  .then(json => {
    data = json;
    renderHeroPanel();
    renderSkins(data);
  })
  .catch(() => {
    console.error('æ— æ³•åŠ è½½ skins.json');
    showToast('åŠ è½½æ•°æ®å¤±è´¥');
  });
</script>
</body>
</html>
