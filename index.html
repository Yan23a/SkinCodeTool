<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>皮肤代码生成器</title>
<style>
/* 全局样式 */
* { box-sizing: border-box; margin: 0; padding: 0; }
body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: #f0f2f5; transition: background 0.3s, color 0.3s; color: #111; }

/* 深色模式 */
body.dark { background: #121212; color: #eee; }

/* 顶部标题栏 */
header {
  background: #111;
  color: #fff;
  padding: 16px;
  text-align: center;
  font-size: 22px;
  font-weight: bold;
  letter-spacing: 1px;
}

/* 页面容器 */
.container { padding: 12px; }

/* 搜索框 */
.search-box input {
  width: 100%;
  padding: 12px;
  font-size: 16px;
  border-radius: 8px;
  border: 1px solid #ccc;
  margin-bottom: 16px;
  transition: border 0.2s;
}
.search-box input:focus { border-color: #007bff; outline: none; }

/* 顶部操作按钮 */
.top-actions {
  display: flex;
  flex-wrap: wrap;
  gap: 8px;
  margin-bottom: 16px;
  align-items: center;
}
.btn, .small-btn {
  padding: 10px 16px;
  border: none;
  border-radius: 8px;
  color: #fff;
  font-size: 14px;
  cursor: pointer;
  transition: 0.2s;
}
.btn { background: #007bff; }
.btn:hover { background: #0056b3; }
.small-btn { background: #555; }
.small-btn:hover { background: #333; }
select.small-btn { padding: 10px; }

/* 卡片样式 */
.card {
  background: #fff;
  border-radius: 12px;
  padding: 12px;
  margin-bottom: 10px;
  display: flex;
  align-items: center;
  justify-content: space-between;
  box-shadow: 0 3px 6px rgba(0,0,0,0.1);
  transition: transform 0.2s, box-shadow 0.2s, background 0.3s;
}
.card:hover { transform: translateY(-2px); box-shadow: 0 6px 12px rgba(0,0,0,0.15); }
body.dark .card { background: #1e1e1e; box-shadow: 0 3px 6px rgba(255,255,255,0.05); }

/* 卡片头像 */
.card .avatar {
  width: 48px;
  height: 48px;
  border-radius: 50%;
  margin-right: 12px;
  object-fit: cover;
}

/* 已选列表 */
.selected-list { margin-top: 20px; }
.line {
  background: #fff;
  border-radius: 8px;
  padding: 10px;
  margin-bottom: 8px;
  display: flex;
  justify-content: space-between;
  align-items: center;
  box-shadow: 0 2px 4px rgba(0,0,0,0.08);
  word-break: break-word;
  opacity: 0;
  animation: fadeIn 0.3s forwards;
  transition: background 0.3s;
}
body.dark .line { background: #1e1e1e; box-shadow: 0 2px 4px rgba(255,255,255,0.05); }

/* 提示框 */
.toast {
  position: fixed;
  bottom: 20px;
  left: 50%;
  transform: translateX(-50%);
  background: #333;
  color: #fff;
  padding: 10px 16px;
  border-radius: 8px;
  display: none;
  z-index: 9999;
}

/* 动画效果 */
@keyframes fadeIn { from { opacity: 0; transform: translateY(-5px); } to { opacity: 1; transform: translateY(0); } }
</style>
</head>
<body>
<header>皮肤代码生成器</header>
<div class="container">
  <div class="search-box">
    <input id="search" placeholder="搜索角色或皮肤...">
  </div>

  <div class="top-actions">
    <button id="copyAll" class="btn">复制全部代码</button>
    <button id="clearAll" class="small-btn">清空</button>
    <select id="formatSelect" class="small-btn">
      <option value="default">默认格式</option>
      <option value="kaito">快斗美化</option>
      <option value="shusheng">书笙美化</option>
    </select>
    <button id="darkToggle" class="small-btn">切换深色模式</button>
  </div>

  <h3>可选皮肤</h3>
  <div id="skinList" class="skins"></div>

  <h3>已选代码</h3>
  <div id="selectedList" class="selected-list"></div>
</div>

<div id="toast" class="toast"></div>

<script>
const search = document.getElementById('search');
const skinList = document.getElementById('skinList');
const selectedList = document.getElementById('selectedList');
const copyAllBtn = document.getElementById('copyAll');
const clearAllBtn = document.getElementById('clearAll');
const toast = document.getElementById('toast');
const formatSelect = document.getElementById('formatSelect');
const darkToggle = document.getElementById('darkToggle');

let data = [];
let selected = [];

// 提示
function showToast(msg){
  toast.innerText = msg;
  toast.style.display = 'block';
  setTimeout(()=> toast.style.display = 'none',1500);
}

// 格式转换
function applyFormat(heroCode, skinCode, name, skinName){
  const f = formatSelect.value;
  if(f === 'kaito') return `${heroCode}-${skinCode}-0  #${name}-${skinName}`;
  if(f === 'shusheng') return `${heroCode} ${skinCode} 1  #${name}-${skinName}`;
  return `${heroCode} ${skinCode}  #${name}-${skinName}`;
}

// 渲染皮肤列表
function renderSkins(list){
  skinList.innerHTML = '';
  list.forEach(ch => {
    ch.skins.forEach(skin => {
      const card = document.createElement('div');
      card.className = 'card';
      const avatarUrl = skin.avatar || 'https://via.placeholder.com/48'; // 默认头像
      card.innerHTML = `
        <div style="display:flex; align-items:center;">
          <img class="avatar" src="${avatarUrl}" alt="${ch.name}">
          <div>
            <strong>${ch.name}</strong> - ${skin.name}<br>
            <small>原始代码：${ch.heroCode}-${skin.skinCode}</small>
          </div>
        </div>
        <button class="btn">添加</button>
      `;
      card.querySelector('button').onclick = () => addSkin(ch.heroCode, skin.skinCode, ch.name, skin.name);
      skinList.appendChild(card);
    });
  });
}

// 添加皮肤
function addSkin(heroCode, skinCode, name, skinName){
  selected.push({ heroCode, skinCode, name, skinName });
  renderSelected();
}

// 渲染已选列表
function renderSelected(){
  selectedList.innerHTML = '';
  selected.forEach((item, idx) => {
    const line = document.createElement('div');
    line.className = 'line';
    line.innerHTML = `
      <div>${applyFormat(item.heroCode, item.skinCode, item.name, item.skinName)}</div>
      <div>
        <button class="small-btn" onclick="copySingle(${idx})">复制</button>
        <button class="small-btn" onclick="removeLine(${idx})">移除</button>
      </div>
    `;
    selectedList.appendChild(line);
  });
}

// 移除单条
function removeLine(i){ selected.splice(i,1); renderSelected(); }

// 复制单条
function copySingle(i){
  const item = selected[i];
  const text = applyFormat(item.heroCode, item.skinCode, item.name, item.skinName);
  navigator.clipboard.writeText(text).then(()=>showToast('已复制')).catch(()=>showToast('复制失败'));
}

// 复制全部
copyAllBtn.onclick = () => {
  if(!selected.length){ showToast('没有可复制的代码'); return; }
  const text = selected.map(s=> applyFormat(s.heroCode,s.skinCode,s.name,s.skinName)).join('\n');
  navigator.clipboard.writeText(text).then(()=>showToast('已复制全部')).catch(()=>showToast('复制失败'));
};

// 清空
clearAllBtn.onclick = () => { selected = []; renderSelected(); showToast('已清空'); };

// 搜索
search.oninput = () => {
  const v = search.value.trim();
  if(!v){ renderSkins(data); return; }
  const filtered = data.map(ch=>({
    name: ch.name,
    heroCode: ch.heroCode,
    skins: ch.skins.filter(s => ch.name.includes(v) || s.name.includes(v))
  })).filter(ch=> ch.skins.length>0);
  renderSkins(filtered);
};

// 格式选择立即刷新已添加列表
formatSelect.onchange = () => { renderSelected(); };

// 深色模式切换
darkToggle.onclick = () => { document.body.classList.toggle('dark'); };

// 加载皮肤数据
fetch('skins.json').then(r=>r.json()).then(json=>{ data=json; renderSkins(data); }).catch(()=>{ console.error('无法加载 skins.json'); });
</script>
</body>
</html>
