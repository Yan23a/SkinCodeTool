<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>皮肤代码生成器</title>
<style>
* { box-sizing: border-box; margin:0; padding:0; }
body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: url('https://images.unsplash.com/photo-1612832020420-7dfe0d2a74b1?auto=format&fit=crop&w=1470&q=80') no-repeat center center fixed; background-size: cover; color: #111; }
header { background-color: rgba(255, 255, 255, 0.5); color:#111; padding:16px; text-align:center; font-size:22px; font-weight:bold; letter-spacing:1px; border-radius:0 0 16px 16px; margin-bottom:12px; }
.container { padding: 12px; }
.search-hero-container { display: flex; gap: 12px; margin-bottom: 12px; }
#toggleHeroPanel { flex: 0 0 auto; }
.search-box { flex: 1; }
.search-box input { width: 100%; padding: 12px; font-size: 16px; border-radius: 8px; border: 1px solid #ccc; }
.top-actions { display: flex; flex-wrap: wrap; gap: 8px; margin-bottom: 8px; align-items: center; }
.btn, .small-btn { padding: 10px 16px; border: none; border-radius: 8px; color: #fff; font-size: 14px; cursor: pointer; transition: 0.2s; }
.btn { background: #007bff; } .btn:hover { background: #0056b3; }
.small-btn { background: #555; } .small-btn:hover { background: #333; }
select.small-btn { padding: 10px; }
.card { background-color: rgba(255,255,255,0.5); border-radius: 12px; padding: 12px; margin-bottom: 10px; display: flex; align-items: center; justify-content: space-between; box-shadow: 0 3px 6px rgba(0,0,0,0.1); transition: 0.2s; }
.card:hover { transform: translateY(-2px); box-shadow: 0 6px 12px rgba(0,0,0,0.15); }
.card .avatar { width: 48px; height: 48px; border-radius: 50%; margin-right: 12px; object-fit: cover; }
.selected-list { margin-top: 20px; }
.line { background-color: rgba(255,255,255,0.5); border-radius: 8px; padding: 10px; margin-bottom: 8px; display: flex; justify-content: space-between; align-items: center; box-shadow: 0 2px 4px rgba(0,0,0,0.08); opacity: 0; animation: fadeIn 0.3s forwards; transition: background 0.3s; }
.line div:first-child { flex: 1; overflow-x: auto; white-space: nowrap; }
.line div:last-child { flex-shrink: 0; display: flex; gap: 6px; }
.toast { position: fixed; bottom: 20px; left: 50%; transform: translateX(-50%); background: #333; color: #fff; padding: 10px 16px; border-radius: 8px; display: none; z-index: 9999; }
.hero-panel { background-color: rgba(255,255,255,0.9); border-radius: 12px; padding: 8px; margin-bottom: 12px; display: none; max-height: 200px; overflow-y: auto; box-shadow: 0 4px 12px rgba(0,0,0,0.2); }
.hero-btn { padding: 8px 14px; border-radius: 8px; background: #007bff; color: #fff; cursor: pointer; transition: 0.2s; margin: 4px 2px; display: block; text-align: center; }
.hero-btn:hover { background: #0056b3; }
.hero-btn.active { background: #28a745; }
@keyframes fadeIn { from { opacity: 0; transform: translateY(-5px); } to { opacity: 1; transform: translateY(0); } }
</style>
</head>
<body>
<header>皮肤代码生成器</header>
<div class="container">
  <div class="search-hero-container">
    <button id="toggleHeroPanel" class="small-btn btn">英雄列表</button>
    <div class="search-box">
      <input id="search" placeholder="搜索角色或皮肤...">
    </div>
  </div>
  <div class="hero-panel" id="heroPanel"></div>
  <div class="top-actions">
    <button id="copyAll" class="btn">复制全部代码</button>
    <button id="clearAll" class="small-btn">清空</button>
    <select id="formatSelect" class="small-btn">
      <option value="default">默认格式</option>
      <option value="kaito">快斗美化</option>
      <option value="shusheng">书笙美化</option>
    </select>
  </div>
  <h3>可选皮肤</h3>
  <div id="skinList" class="skins"></div>
  <h3>已选代码</h3>
  <div id="selectedList" class="selected-list"></div>
</div>
<div id="toast" class="toast"></div>
<script>
const search=document.getElementById('search');
const skinList=document.getElementById('skinList');
const selectedList=document.getElementById('selectedList');
const copyAllBtn=document.getElementById('copyAll');
const clearAllBtn=document.getElementById('clearAll');
const toast=document.getElementById('toast');
const formatSelect=document.getElementById('formatSelect');
const toggleHeroPanelBtn=document.getElementById('toggleHeroPanel');
const heroPanel=document.getElementById('heroPanel');
let data=[],selected=[],currentHero=null;

function showToast(msg){ toast.innerText=msg; toast.style.display='block'; setTimeout(()=>toast.style.display='none',1500); }
function applyFormat(heroCode, skinCode, name, skinName){
  const f=formatSelect.value;
  if(f==='kaito') return `${heroCode}-${skinCode}-0  #${name}-${skinName}`;
  if(f==='shusheng') return `${heroCode} ${skinCode} 1  #${name}-${skinName}`;
  return `${heroCode} ${skinCode}  #${name}-${skinName}`;
}

function renderHeroPanel(){
  heroPanel.innerHTML='';
  data.forEach(ch=>{
    const btn=document.createElement('div');
    btn.className='hero-btn'+(currentHero===ch.name?' active':'');
    btn.innerText=ch.name;
    btn.onclick=()=>{
      currentHero=currentHero===ch.name?null:ch.name;
      renderHeroPanel();
      renderSkins(currentHero?data.filter(ch2=>ch2.name===currentHero):data);
    };
    heroPanel.appendChild(btn);
  });
}

function getFilteredSkins(){
  let list=data;
  if(currentHero) list=list.filter(ch=>ch.name===currentHero);
  const v=search.value.trim();
  if(v) list=list.map(ch=>({name:ch.name,heroCode:ch.heroCode,skins:ch.skins.filter(s=>ch.name.includes(v)||s.name.includes(v))})).filter(ch=>ch.skins.length>0);
  return list;
}

function renderSkins(list){
  skinList.innerHTML='';
  list.forEach(ch=>{
    ch.skins.forEach(skin=>{
      const card=document.createElement('div');
      card.className='card';
      const avatarUrl=skin.avatar||'https://via.placeholder.com/48';
      card.innerHTML=`<div style="display:flex;align-items:center;"><img class="avatar" src="${avatarUrl}" alt="${ch.name}"><div><strong>${ch.name}</strong> - ${skin.name}<br><small>原始代码：${ch.heroCode}-${skin.skinCode}</small></div></div><button class="btn">添加</button>`;
      card.querySelector('button').onclick=()=>addSkin(ch.heroCode,skin.skinCode,ch.name,skin.name);
      skinList.appendChild(card);
    });
  });
}

function addSkin(heroCode, skinCode, name, skinName){ selected.push({heroCode,skinCode,name,skinName}); renderSelected(); }
function renderSelected(){ selectedList.innerHTML=''; selected.forEach((item,idx)=>{ const line=document.createElement('div'); line.className='line'; line.innerHTML=`<div>${applyFormat(item.heroCode,item.skinCode,item.name,item.skinName)}</div><div><button class="small-btn" onclick="copySingle(${idx})">复制</button><button class="small-btn" onclick="removeLine(${idx})">移除</button></div>`; selectedList.appendChild(line); }); }
function removeLine(i){ selected.splice(i,1); renderSelected(); }
function copySingle(i){ const item=selected[i]; const text=applyFormat(item.heroCode,item.skinCode,item.name,item.skinName); navigator.clipboard.writeText(text).then(()=>showToast('已复制')).catch(()=>showToast('复制失败')); }

copyAllBtn.onclick=()=>{ if(!selected.length){ showToast('没有可复制的代码'); return; } const text=selected.map(s=>applyFormat(s.heroCode,s.skinCode,s.name,s.skinName)).join('\n'); navigator.clipboard.writeText(text).then(()=>showToast('已复制全部')).catch(()=>showToast('复制失败')); };
clearAllBtn.onclick=()=>{ selected=[]; renderSelected(); showToast('已清空'); };
search.oninput=()=>{ renderSkins(getFilteredSkins()); };
formatSelect.onchange=()=>{ renderSelected(); };
toggleHeroPanelBtn.onclick=()=>{ heroPanel.style.display=(heroPanel.style.display==='block'?'none':'block'); renderHeroPanel(); };

fetch('skins.json').then(r=>r.json()).then(json=>{ data=json; renderHeroPanel(); renderSkins(data); }).catch(()=>{ console.error('无法加载 skins.json'); });
</script>
</body>
</html>
